<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Untitled</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="generator" content="CoolUtils HTML exporter" />
<style type="text/css">
<!--
body { color: #000000; background-color: #FFFFFF; }
.python1-classname { color: #000080; font-weight: bold; }
.python1-comment { color: #808080; font-style: italic; }
.python1-commentedcode { color: #C0C0C0; font-style: italic; }
.python1-documentation { color: #CC00FF; }
.python1-float { color: #008080; }
.python1-functionname { color: #008080; font-weight: bold; }
.python1-hexadecimal { color: #008080; }
.python1-identifier { color: #000000; }
.python1-matchingbrace { color: #0000FF; font-weight: bold; }
.python1-multi-linestring { color: #808000; }
.python1-nonreservedkeyword { color: #000080; }
.python1-number { color: #008080; }
.python1-octal { color: #008080; }
.python1-reservedword { font-weight: bold; }
.python1-space { color: #C0C0C0; }
.python1-string { color: #808000; }
.python1-symbol { color: #800000; }
.python1-syntaxerror { color: #FF0000; }
.python1-systemfunctionsandvariables { font-weight: bold; }
.python1-unbalancedbrace { color: #FFFF00; }
-->
</style>
</head>
<body>
<!--StartFragment--><pre><code><span class="python1-comment"># -*- coding: utf-8 -*-
</span><span class="python1-documentation">&quot;&quot;&quot;energy_dataset_cleaning.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1a8GZKdvLO_GUVsHHI6EVx4pqknihdZda
&quot;&quot;&quot;

</span><span class="python1-reservedword">import</span><span class="python1-space"> </span><span class="python1-identifier">pandas</span><span class="python1-space"> </span><span class="python1-reservedword">as</span><span class="python1-space"> </span><span class="python1-identifier">pd

gen_file</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-string">'/content/drive/MyDrive/Portfolio/Energy/energy.csv'
</span><span class="python1-identifier">weather_file</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-string">'/content/drive/MyDrive/Portfolio/Energy/weather_features.csv'

</span><span class="python1-comment">#load datasets
</span><span class="python1-identifier">df_gen</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">pd</span><span class="python1-symbol">.</span><span class="python1-identifier">read_csv</span><span class="python1-symbol">(</span><span class="python1-identifier">gen_file</span><span class="python1-symbol">)
</span><span class="python1-identifier">df_weather</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">pd</span><span class="python1-symbol">.</span><span class="python1-identifier">read_csv</span><span class="python1-symbol">(</span><span class="python1-identifier">weather_file</span><span class="python1-symbol">)

</span><span class="python1-reservedword">print</span><span class="python1-symbol">(</span><span class="python1-identifier">df_weather</span><span class="python1-symbol">.</span><span class="python1-identifier">columns</span><span class="python1-symbol">)

</span><span class="python1-reservedword">print</span><span class="python1-symbol">(</span><span class="python1-identifier">df_gen</span><span class="python1-symbol">.</span><span class="python1-identifier">columns</span><span class="python1-symbol">)

</span><span class="python1-comment">#handle datetime

#rename columns
</span><span class="python1-identifier">df_gen</span><span class="python1-symbol">.</span><span class="python1-identifier">rename</span><span class="python1-symbol">(</span><span class="python1-identifier">columns</span><span class="python1-symbol">={</span><span class="python1-string">'time'</span><span class="python1-symbol">:</span><span class="python1-space"> </span><span class="python1-string">'datetime'</span><span class="python1-symbol">},</span><span class="python1-space"> </span><span class="python1-identifier">inplace</span><span class="python1-symbol">=</span><span class="python1-nonreservedkeyword">True</span><span class="python1-symbol">)
</span><span class="python1-identifier">df_weather</span><span class="python1-symbol">.</span><span class="python1-identifier">rename</span><span class="python1-symbol">(</span><span class="python1-identifier">columns</span><span class="python1-symbol">={</span><span class="python1-string">'dt_iso'</span><span class="python1-symbol">:</span><span class="python1-space"> </span><span class="python1-string">'datetime'</span><span class="python1-symbol">},</span><span class="python1-space"> </span><span class="python1-identifier">inplace</span><span class="python1-symbol">=</span><span class="python1-nonreservedkeyword">True</span><span class="python1-symbol">)

</span><span class="python1-comment">#convert to datetime with UTC
</span><span class="python1-identifier">df_gen</span><span class="python1-symbol">[</span><span class="python1-string">'datetime'</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">pd</span><span class="python1-symbol">.</span><span class="python1-identifier">to_datetime</span><span class="python1-symbol">(</span><span class="python1-identifier">df_gen</span><span class="python1-symbol">[</span><span class="python1-string">'datetime'</span><span class="python1-symbol">],</span><span class="python1-space"> </span><span class="python1-identifier">utc</span><span class="python1-symbol">=</span><span class="python1-nonreservedkeyword">True</span><span class="python1-symbol">)
</span><span class="python1-identifier">df_weather</span><span class="python1-symbol">[</span><span class="python1-string">'datetime'</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">pd</span><span class="python1-symbol">.</span><span class="python1-identifier">to_datetime</span><span class="python1-symbol">(</span><span class="python1-identifier">df_weather</span><span class="python1-symbol">[</span><span class="python1-string">'datetime'</span><span class="python1-symbol">],</span><span class="python1-space"> </span><span class="python1-identifier">utc</span><span class="python1-symbol">=</span><span class="python1-nonreservedkeyword">True</span><span class="python1-symbol">)

</span><span class="python1-comment">#remove timezone for Tableau
</span><span class="python1-identifier">df_gen</span><span class="python1-symbol">[</span><span class="python1-string">'datetime'</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">df_gen</span><span class="python1-symbol">[</span><span class="python1-string">'datetime'</span><span class="python1-symbol">].</span><span class="python1-identifier">dt</span><span class="python1-symbol">.</span><span class="python1-identifier">tz_localize</span><span class="python1-symbol">(</span><span class="python1-nonreservedkeyword">None</span><span class="python1-symbol">)
</span><span class="python1-identifier">df_weather</span><span class="python1-symbol">[</span><span class="python1-string">'datetime'</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">df_weather</span><span class="python1-symbol">[</span><span class="python1-string">'datetime'</span><span class="python1-symbol">].</span><span class="python1-identifier">dt</span><span class="python1-symbol">.</span><span class="python1-identifier">tz_localize</span><span class="python1-symbol">(</span><span class="python1-nonreservedkeyword">None</span><span class="python1-symbol">)

</span><span class="python1-comment">#merge datasets on datetime
</span><span class="python1-identifier">df</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">pd</span><span class="python1-symbol">.</span><span class="python1-identifier">merge</span><span class="python1-symbol">(</span><span class="python1-identifier">df_gen</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">df_weather</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">on</span><span class="python1-symbol">=</span><span class="python1-string">'datetime'</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">how</span><span class="python1-symbol">=</span><span class="python1-string">'left'</span><span class="python1-symbol">)

</span><span class="python1-comment">#filling missing values

#generation columns
</span><span class="python1-identifier">generation_cols</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-symbol">[</span><span class="python1-identifier">col</span><span class="python1-space"> </span><span class="python1-reservedword">for</span><span class="python1-space"> </span><span class="python1-identifier">col</span><span class="python1-space"> </span><span class="python1-reservedword">in</span><span class="python1-space"> </span><span class="python1-identifier">df_gen</span><span class="python1-symbol">.</span><span class="python1-identifier">columns</span><span class="python1-space"> </span><span class="python1-reservedword">if</span><span class="python1-space"> </span><span class="python1-identifier">col</span><span class="python1-symbol">.</span><span class="python1-identifier">startswith</span><span class="python1-symbol">(</span><span class="python1-string">'generation'</span><span class="python1-symbol">)]
</span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-identifier">generation_cols</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-identifier">generation_cols</span><span class="python1-symbol">].</span><span class="python1-identifier">fillna</span><span class="python1-symbol">(</span><span class="python1-number">0</span><span class="python1-symbol">)

</span><span class="python1-comment">#weather columns
</span><span class="python1-identifier">weather_cols</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-symbol">[</span><span class="python1-string">'temp'</span><span class="python1-symbol">,</span><span class="python1-string">'temp_min'</span><span class="python1-symbol">,</span><span class="python1-string">'temp_max'</span><span class="python1-symbol">,</span><span class="python1-string">'pressure'</span><span class="python1-symbol">,</span><span class="python1-string">'humidity'</span><span class="python1-symbol">,</span><span class="python1-string">'wind_speed'</span><span class="python1-symbol">,</span><span class="python1-string">'wind_deg'</span><span class="python1-symbol">,
</span><span class="python1-space">                </span><span class="python1-string">'rain_1h'</span><span class="python1-symbol">,</span><span class="python1-string">'rain_3h'</span><span class="python1-symbol">,</span><span class="python1-string">'snow_3h'</span><span class="python1-symbol">,</span><span class="python1-string">'clouds_all'</span><span class="python1-symbol">]
</span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-identifier">weather_cols</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-identifier">weather_cols</span><span class="python1-symbol">].</span><span class="python1-identifier">fillna</span><span class="python1-symbol">(</span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-identifier">weather_cols</span><span class="python1-symbol">].</span><span class="python1-identifier">mean</span><span class="python1-symbol">())

</span><span class="python1-comment">#convert temp from Kelvin to Celsius
</span><span class="python1-reservedword">for</span><span class="python1-space"> </span><span class="python1-identifier">col</span><span class="python1-space"> </span><span class="python1-reservedword">in</span><span class="python1-space"> </span><span class="python1-symbol">[</span><span class="python1-string">'temp'</span><span class="python1-symbol">,</span><span class="python1-string">'temp_min'</span><span class="python1-symbol">,</span><span class="python1-string">'temp_max'</span><span class="python1-symbol">]:
</span><span class="python1-space">    </span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-identifier">col</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-identifier">col</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">-</span><span class="python1-space"> </span><span class="python1-float">273.15

</span><span class="python1-comment">#calculated fields

#total generation
</span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-string">'total_generation'</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-identifier">generation_cols</span><span class="python1-symbol">].</span><span class="python1-identifier">sum</span><span class="python1-symbol">(</span><span class="python1-identifier">axis</span><span class="python1-symbol">=</span><span class="python1-number">1</span><span class="python1-symbol">)

</span><span class="python1-comment">#renewable share
</span><span class="python1-identifier">renewable_cols</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-symbol">[
</span><span class="python1-space">    </span><span class="python1-string">'generation solar'</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-string">'generation wind onshore'</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-string">'generation wind offshore'</span><span class="python1-symbol">,
</span><span class="python1-space">    </span><span class="python1-string">'generation other renewable'</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-string">'generation hydro run-of-river and poundage'</span><span class="python1-symbol">,
</span><span class="python1-space">    </span><span class="python1-string">'generation hydro water reservoir'
</span><span class="python1-symbol">]
</span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-string">'renewable_generation'</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-identifier">renewable_cols</span><span class="python1-symbol">].</span><span class="python1-identifier">sum</span><span class="python1-symbol">(</span><span class="python1-identifier">axis</span><span class="python1-symbol">=</span><span class="python1-number">1</span><span class="python1-symbol">)
</span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-string">'renewable_share'</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-string">'renewable_generation'</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">/</span><span class="python1-space"> </span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-string">'total_generation'</span><span class="python1-symbol">]

</span><span class="python1-comment">#demand supply gap
</span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-string">'demand_supply_gap'</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-string">'total load actual'</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">-</span><span class="python1-space"> </span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-string">'total_generation'</span><span class="python1-symbol">]

</span><span class="python1-comment">#extract year, month, day, hour
</span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-string">'year'</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-string">'datetime'</span><span class="python1-symbol">].</span><span class="python1-identifier">dt</span><span class="python1-symbol">.</span><span class="python1-identifier">year
df</span><span class="python1-symbol">[</span><span class="python1-string">'month'</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-string">'datetime'</span><span class="python1-symbol">].</span><span class="python1-identifier">dt</span><span class="python1-symbol">.</span><span class="python1-identifier">month
df</span><span class="python1-symbol">[</span><span class="python1-string">'day'</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-string">'datetime'</span><span class="python1-symbol">].</span><span class="python1-identifier">dt</span><span class="python1-symbol">.</span><span class="python1-identifier">day
df</span><span class="python1-symbol">[</span><span class="python1-string">'hour'</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">df</span><span class="python1-symbol">[</span><span class="python1-string">'datetime'</span><span class="python1-symbol">].</span><span class="python1-identifier">dt</span><span class="python1-symbol">.</span><span class="python1-identifier">hour

</span><span class="python1-comment">#daily aggregation
</span><span class="python1-identifier">sum_cols</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">generation_cols</span><span class="python1-space"> </span><span class="python1-symbol">+</span><span class="python1-space"> </span><span class="python1-symbol">[</span><span class="python1-string">'total load actual'</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-string">'total_generation'</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-string">'demand_supply_gap'</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-string">'renewable_generation'</span><span class="python1-symbol">]
</span><span class="python1-identifier">avg_cols</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">weather_cols</span><span class="python1-space"> </span><span class="python1-symbol">+</span><span class="python1-space"> </span><span class="python1-symbol">[</span><span class="python1-string">'renewable_share'</span><span class="python1-symbol">]

</span><span class="python1-identifier">df_daily</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">df</span><span class="python1-symbol">.</span><span class="python1-identifier">groupby</span><span class="python1-symbol">([</span><span class="python1-string">'year'</span><span class="python1-symbol">,</span><span class="python1-string">'month'</span><span class="python1-symbol">,</span><span class="python1-string">'day'</span><span class="python1-symbol">]).</span><span class="python1-identifier">agg</span><span class="python1-symbol">(
</span><span class="python1-space">    </span><span class="python1-symbol">{**{</span><span class="python1-identifier">col</span><span class="python1-symbol">:</span><span class="python1-string">'sum'</span><span class="python1-space"> </span><span class="python1-reservedword">for</span><span class="python1-space"> </span><span class="python1-identifier">col</span><span class="python1-space"> </span><span class="python1-reservedword">in</span><span class="python1-space"> </span><span class="python1-identifier">sum_cols</span><span class="python1-symbol">},
</span><span class="python1-space">     </span><span class="python1-symbol">**{</span><span class="python1-identifier">col</span><span class="python1-symbol">:</span><span class="python1-string">'mean'</span><span class="python1-space"> </span><span class="python1-reservedword">for</span><span class="python1-space"> </span><span class="python1-identifier">col</span><span class="python1-space"> </span><span class="python1-reservedword">in</span><span class="python1-space"> </span><span class="python1-identifier">avg_cols</span><span class="python1-symbol">}}
).</span><span class="python1-identifier">reset_index</span><span class="python1-symbol">()

</span><span class="python1-comment">#recreate date column for Tableau
</span><span class="python1-identifier">df_daily</span><span class="python1-symbol">[</span><span class="python1-string">'date'</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">pd</span><span class="python1-symbol">.</span><span class="python1-identifier">to_datetime</span><span class="python1-symbol">(</span><span class="python1-identifier">df_daily</span><span class="python1-symbol">[[</span><span class="python1-string">'year'</span><span class="python1-symbol">,</span><span class="python1-string">'month'</span><span class="python1-symbol">,</span><span class="python1-string">'day'</span><span class="python1-symbol">]])
</span><span class="python1-identifier">df_daily</span><span class="python1-symbol">[</span><span class="python1-string">'month_year'</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">df_daily</span><span class="python1-symbol">[</span><span class="python1-string">'date'</span><span class="python1-symbol">].</span><span class="python1-identifier">dt</span><span class="python1-symbol">.</span><span class="python1-identifier">strftime</span><span class="python1-symbol">(</span><span class="python1-string">'%b-%Y'</span><span class="python1-symbol">)</span><span class="python1-space">  </span><span class="python1-comment"># e.g., Jan-2026

#save cleaned CSV ---
</span><span class="python1-identifier">df_daily</span><span class="python1-symbol">.</span><span class="python1-identifier">to_csv</span><span class="python1-symbol">(</span><span class="python1-string">'/content/energy_cleaned_daily_full_sources.csv'</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">index</span><span class="python1-symbol">=</span><span class="python1-nonreservedkeyword">False</span><span class="python1-symbol">)

</span><span class="python1-comment">#month number to month name
</span><span class="python1-identifier">df_daily</span><span class="python1-symbol">[</span><span class="python1-string">'month_name'</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">df_daily</span><span class="python1-symbol">[</span><span class="python1-string">'date'</span><span class="python1-symbol">].</span><span class="python1-identifier">dt</span><span class="python1-symbol">.</span><span class="python1-identifier">strftime</span><span class="python1-symbol">(</span><span class="python1-string">'%B'</span><span class="python1-symbol">)

</span><span class="python1-comment">#define function to map month to season
</span><span class="python1-reservedword">def</span><span class="python1-space"> </span><span class="python1-functionname">month_to_season</span><span class="python1-symbol">(</span><span class="python1-identifier">month</span><span class="python1-symbol">):
</span><span class="python1-space">    </span><span class="python1-reservedword">if</span><span class="python1-space"> </span><span class="python1-identifier">month</span><span class="python1-space"> </span><span class="python1-reservedword">in</span><span class="python1-space"> </span><span class="python1-symbol">[</span><span class="python1-number">12</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-number">1</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-number">2</span><span class="python1-symbol">]:
</span><span class="python1-space">        </span><span class="python1-reservedword">return</span><span class="python1-space"> </span><span class="python1-string">'Winter'
</span><span class="python1-space">    </span><span class="python1-reservedword">elif</span><span class="python1-space"> </span><span class="python1-identifier">month</span><span class="python1-space"> </span><span class="python1-reservedword">in</span><span class="python1-space"> </span><span class="python1-symbol">[</span><span class="python1-number">3</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-number">4</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-number">5</span><span class="python1-symbol">]:
</span><span class="python1-space">        </span><span class="python1-reservedword">return</span><span class="python1-space"> </span><span class="python1-string">'Spring'
</span><span class="python1-space">    </span><span class="python1-reservedword">elif</span><span class="python1-space"> </span><span class="python1-identifier">month</span><span class="python1-space"> </span><span class="python1-reservedword">in</span><span class="python1-space"> </span><span class="python1-symbol">[</span><span class="python1-number">6</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-number">7</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-number">8</span><span class="python1-symbol">]:
</span><span class="python1-space">        </span><span class="python1-reservedword">return</span><span class="python1-space"> </span><span class="python1-string">'Summer'
</span><span class="python1-space">    </span><span class="python1-reservedword">elif</span><span class="python1-space"> </span><span class="python1-identifier">month</span><span class="python1-space"> </span><span class="python1-reservedword">in</span><span class="python1-space"> </span><span class="python1-symbol">[</span><span class="python1-number">9</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-number">10</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-number">11</span><span class="python1-symbol">]:
</span><span class="python1-space">        </span><span class="python1-reservedword">return</span><span class="python1-space"> </span><span class="python1-string">'Fall'

</span><span class="python1-space"> </span><span class="python1-comment">#create a new season column from function
</span><span class="python1-identifier">df_daily</span><span class="python1-symbol">[</span><span class="python1-string">'season'</span><span class="python1-symbol">]</span><span class="python1-space"> </span><span class="python1-symbol">=</span><span class="python1-space"> </span><span class="python1-identifier">df_daily</span><span class="python1-symbol">[</span><span class="python1-string">'month'</span><span class="python1-symbol">].</span><span class="python1-identifier">apply</span><span class="python1-symbol">(</span><span class="python1-identifier">month_to_season</span><span class="python1-symbol">)

</span><span class="python1-reservedword">from</span><span class="python1-space"> </span><span class="python1-identifier">google</span><span class="python1-symbol">.</span><span class="python1-identifier">colab</span><span class="python1-space"> </span><span class="python1-reservedword">import</span><span class="python1-space"> </span><span class="python1-identifier">files

</span><span class="python1-comment"># Make sure your cleaned CSV is saved
</span><span class="python1-identifier">df_daily</span><span class="python1-symbol">.</span><span class="python1-identifier">to_csv</span><span class="python1-symbol">(</span><span class="python1-string">'/content/energy.csv'</span><span class="python1-symbol">,</span><span class="python1-space"> </span><span class="python1-identifier">index</span><span class="python1-symbol">=</span><span class="python1-nonreservedkeyword">False</span><span class="python1-symbol">)

</span><span class="python1-comment"># Download it to your desktop
</span><span class="python1-identifier">files</span><span class="python1-symbol">.</span><span class="python1-identifier">download</span><span class="python1-symbol">(</span><span class="python1-string">'/content/energy.csv'</span><span class="python1-symbol">)

</span><span class="python1-reservedword">print</span><span class="python1-symbol">(</span><span class="python1-identifier">df_daily</span><span class="python1-symbol">[[</span><span class="python1-string">'total_generation'</span><span class="python1-symbol">,</span><span class="python1-string">'temp'</span><span class="python1-symbol">,</span><span class="python1-string">'wind_speed'</span><span class="python1-symbol">]].</span><span class="python1-identifier">describe</span><span class="python1-symbol">())
</span></code></pre><!--EndFragment--></body>
</html>